# Azure Penetration Testing Skills

A comprehensive set of Claude Code skills for Azure penetration testing.

## Skill Categories

| Category | Skills | Purpose |
|----------|--------|---------|
| **Project Management** | azure-pentest-init | Initialize projects, methodology guidance |
| **Enumeration** | azure-enum | Azure CLI commands, output analysis |
| **Identity Analysis** | roadtools-helper, azurehound-helper | Azure AD deep-dive, attack paths |
| **Compliance & Config** | prowler-azure, scoutsuite-azure, Monkey365 | CIS benchmarks, security posture |
| **Entra ID Testing** | Maester | Continuous security validation, MITRE mapping |
| **Documentation** | azure-findings | Finding analysis, severity assessment |

---

## Available Skills

### 1. `/azure-pentest-init` - Project Manager
**Purpose**: Initialize new Azure pentest projects and provide ongoing methodology guidance

**Use when**:
- Starting a new Azure engagement (creates full project structure)
- Need methodology guidance during an active engagement
- Want to check progress and get next step recommendations

**What it does**:
- Creates Obsidian vault structure with all necessary files
- Generates automation scripts (enum.sh, quick-checks.sh)
- Provides command library and templates
- Tracks progress through testing phases
- Suggests next steps based on current phase

**Example usage**:
```
/azure-pentest-init
```

---

### 2. `/azure-enum` - Enumeration Expert
**Purpose**: Azure CLI command generation and output analysis

**Use when**:
- Need specific Azure CLI commands for enumeration
- Want to analyze command outputs
- Looking for security misconfigurations during enumeration
- Need suggestions for next enumeration steps

**What it does**:
- Provides exact Azure CLI commands for your objective
- Explains what to look for in outputs
- Identifies interesting findings from command results
- Suggests follow-up commands based on discoveries
- Helps save and organize outputs

**Example usage**:
```
/azure-enum
"I want to enumerate all storage accounts and check for public access"
```

---

### 3. `/roadtools-helper` - ROADtools Specialist
**Purpose**: ROADrecon and ROADtools GUI guidance and analysis

**Use when**:
- Starting ROADtools data collection
- Analyzing Azure AD data in ROADtools GUI
- Need help with database queries
- Looking for privilege escalation paths in Azure AD
- Want to understand ROADtools output

**What it does**:
- Guides through authentication and data collection
- Suggests what to investigate in GUI
- Provides SQLite queries for database analysis
- Identifies high-value targets and overprivileged accounts
- Explains privilege escalation paths in Azure AD

**Example usage**:
```
/roadtools-helper
"I've gathered data with roadrecon, what should I look at first?"
```

---

### 4. `/azurehound-helper` - AzureHound & BloodHound Expert
**Purpose**: AzureHound collection and BloodHound analysis for Azure

**Use when**:
- Running AzureHound data collection
- Importing data into BloodHound
- Need Cypher queries for Azure analysis
- Looking for attack paths to high-value targets
- Want to understand Azure relationships in BloodHound

**What it does**:
- Provides AzureHound collection commands
- Guides Neo4j/BloodHound setup
- Suggests pre-built and custom Cypher queries
- Explains Azure-specific edges and relationships
- Identifies and explains attack paths

**Example usage**:
```
/azurehound-helper
"How do I find privilege escalation paths from my current user?"
```

---

### 5. `/azure-findings` - Findings Analyst
**Purpose**: Analyze outputs and format findings for documentation

**Use when**:
- Have raw command output to analyze
- Need help identifying security issues
- Want to assess finding severity
- Ready to document findings
- Need remediation recommendations

**What it does**:
- Parses command outputs and tool results
- Identifies security misconfigurations
- Assesses severity (Critical/High/Medium/Low)
- Explains impact and attack scenarios
- Formats findings ready for Findings.md
- Suggests remediation steps

**Example usage**:
```
/azure-findings
[paste command output]
```

---

### 6. `/prowler-azure` - Compliance Scanner
**Purpose**: Azure security posture assessment with CIS benchmarks

**Use when**:
- Need CIS Azure Foundations compliance check
- Running comprehensive Azure infrastructure audit
- Want HIPAA/PCI-DSS/ISO27001 compliance mapping
- Generating compliance reports

**What it does**:
- 169+ security checks across 22 Azure services
- CIS, PCI-DSS, HIPAA, ISO27001 compliance frameworks
- HTML/JSON/CSV reporting
- Severity-based prioritization

**Example usage**:
```
/prowler-azure
"run CIS benchmark compliance scan"
```

---

### 7. `/scoutsuite-azure` - Configuration Auditor
**Purpose**: Quick Azure configuration security audit

**Use when**:
- Need fast initial configuration review
- Want visual HTML dashboard
- Starting Azure infrastructure assessment
- Need quick wins identification

**What it does**:
- Multi-service configuration audit
- Interactive HTML reports
- Risk-based findings
- Easy-to-navigate dashboard

**Example usage**:
```
/scoutsuite-azure
"run configuration audit"
```

---

### 8. `/Monkey365` - M365 Security Specialist
**Purpose**: Microsoft 365, Azure, and Entra ID security configuration reviews

**Use when**:
- Heavy Microsoft 365 footprint (Exchange, SharePoint, Teams)
- Need CIS M365 benchmark compliance
- Assessing Entra ID alongside M365 services
- Want detailed workload configuration analysis

**What it does**:
- 160+ checks across M365, Azure, Entra ID
- CIS Microsoft 365 and Azure benchmarks
- Exchange, SharePoint, Teams deep-dive
- HTML/CSV/JSON reporting

**Example usage**:
```
/Monkey365
"run M365 security assessment with CIS compliance"
```

---

### 9. `/Maester` - Entra ID Security Tester
**Purpose**: Continuous Entra ID security validation with MITRE ATT&CK mapping

**Use when**:
- Focus is Entra ID security hardening
- Need MITRE ATT&CK-mapped testing
- Implementing continuous security monitoring
- Validating Conditional Access effectiveness
- Want CISA SCuBA baseline testing

**What it does**:
- 280+ security tests (EIDSCA, CISA SCuBA, Microsoft)
- MITRE ATT&CK technique mapping
- Pester-based repeatable testing
- CI/CD pipeline integration
- Custom test creation support

**Example usage**:
```
/Maester
"run Entra ID security tests with MITRE mapping"
```

---

## Typical Workflow

### Starting a New Engagement

1. **Initialize project**:
   ```
   /azure-pentest-init
   ```
   Answer prompts about client name, credentials, tenant, etc.

2. **Review created structure**:
   - Check Azure Creds.md for credentials
   - Review Commands.md for available commands
   - Open Notes.md for methodology tracking

3. **Start enumeration**:
   ```bash
   cd Scripts
   ./enum.sh
   ```

### During Enumeration

4. **Get specific enumeration commands**:
   ```
   /azure-enum
   "enumerate all key vaults and check if I can list secrets"
   ```

5. **Analyze outputs**:
   ```
   /azure-findings
   [paste the output from your command]
   ```

6. **Document interesting findings** in Findings.md

### Deep Dive Analysis

7. **Run ROADtools**:
   ```
   /roadtools-helper
   "help me collect Azure AD data"
   ```

8. **Analyze in GUI, then ask**:
   ```
   /roadtools-helper
   "I found 5 Global Admins, what should I investigate next?"
   ```

9. **Run AzureHound and BloodHound**:
   ```
   /azurehound-helper
   "help me collect data and import to BloodHound"
   ```

10. **Find attack paths**:
    ```
    /azurehound-helper
    "find privilege escalation paths from my current user"
    ```

### Compliance & Configuration Audits

11. **Azure Infrastructure Compliance**:
    ```
    /prowler-azure
    "run CIS Azure benchmark scan"
    ```

12. **Microsoft 365 Security Review** (if M365 in scope):
    ```
    /Monkey365
    "run full M365 security assessment"
    ```

13. **Entra ID Hardening Validation**:
    ```
    /Maester
    "run Entra ID security tests"
    ```

### Throughout Engagement

11. **Check progress and get guidance**:
    ```
    /azure-pentest-init
    ```
    (In existing project - provides methodology guidance)

12. **Quick misconfiguration scan**:
    ```bash
    cd Scripts
    ./quick-checks.sh
    ```

---

## Skill Interactions

Skills work together seamlessly:

**azure-pentest-init** â†’ Sets up project, recommends other skills based on phase

**azure-enum** â†’ Provides commands â†’ **azure-findings** analyzes output

**roadtools-helper** â†’ Identifies targets â†’ **azurehound-helper** finds paths to them

**azure-findings** â†’ Formats findings â†’ Updates Findings.md

---

## Project Structure

Each engagement initialized by `/azure-pentest-init` creates:

```
CLIENT_NAME/
â”œâ”€â”€ Azure Creds.md           # Credentials
â”œâ”€â”€ Commands.md              # Command library
â”œâ”€â”€ Notes.md                 # Running notes + progress tracking
â”œâ”€â”€ Findings.md              # Documented findings
â”œâ”€â”€ Scripts/
â”‚   â”œâ”€â”€ enum.sh             # Automated enumeration
â”‚   â””â”€â”€ quick-checks.sh     # Misconfiguration scanner
â””â”€â”€ outputs/                 # All command outputs (timestamped)
```

---

## Best Practices

1. **Start every engagement** with `/azure-pentest-init` - it sets up everything

2. **Use specialized skills** for specific tasks rather than generic questions

3. **Save all outputs** to the outputs/ directory with timestamps

4. **Document as you go** - use `/azure-findings` to format findings immediately

5. **Check methodology progress** periodically with `/azure-pentest-init`

6. **Chain skills together**:
   - `/azure-enum` for commands
   - Run command
   - `/azure-findings` to analyze output
   - Document in Findings.md

7. **Use automation scripts** (enum.sh, quick-checks.sh) for comprehensive sweeps

8. **Keep Notes.md updated** with stream-of-consciousness observations

---

## ðŸ“š Documentation

### Quick Reference Guides

1. **AZURE_SKILLS_README.md** (this file) - Complete skill documentation
2. **AZURE_PENTEST_QUICKSTART.md** - Comprehensive quick start guide for new engagements
3. **AZURE_PENTEST_CHEATSHEET.md** - One-page reference card for active engagements

**Recommended reading order**:
- First time: Read this README completely
- Starting engagement: Follow QUICKSTART guide
- During engagement: Keep CHEATSHEET handy

---

## Quick Reference

| Task | Skill | Command |
|------|-------|---------|
| Start new project | azure-pentest-init | `/azure-pentest-init` |
| Get enumeration commands | azure-enum | `/azure-enum` |
| Analyze command output | azure-findings | `/azure-findings` |
| ROADtools help | roadtools-helper | `/roadtools-helper` |
| BloodHound/AzureHound help | azurehound-helper | `/azurehound-helper` |
| Azure CIS compliance | prowler-azure | `/prowler-azure` |
| Azure quick config audit | scoutsuite-azure | `/scoutsuite-azure` |
| M365 security review | Monkey365 | `/Monkey365` |
| Entra ID security tests | Maester | `/Maester` |
| Check progress | azure-pentest-init | `/azure-pentest-init` |

---

## Tool Selection Guide

### Which Compliance Tool?

| Scenario | Recommended Tool | Why |
|----------|------------------|-----|
| Azure infrastructure focus | **Prowler** | 169+ checks, broad Azure coverage |
| Quick visual overview | **ScoutSuite** | Fast, good HTML dashboard |
| Heavy M365 (Exchange/SharePoint/Teams) | **Monkey365** | Best M365 workload coverage |
| Entra ID hardening | **Maester** | 280+ tests, MITRE mapping, CI/CD ready |
| Comprehensive assessment | **Prowler + Monkey365 + Maester** | Combined coverage |

### Which Identity Tool?

| Scenario | Recommended Tool | Why |
|----------|------------------|-----|
| Azure AD database export & queries | **ROADtools** | SQLite database, offline analysis |
| Attack path visualization | **AzureHound/BloodHound** | Graph-based path finding |
| Privilege escalation hunting | **Both** | ROADtools finds targets, AzureHound finds paths |

---

## Tips

- **Paste raw outputs** directly to `/azure-findings` for instant analysis
- **Be specific** when invoking skills - include your objective or question
- **Reference skill suggestions** - when one skill recommends another, use it
- Skills **maintain context** - they can see your project files
- **Combine skills** with regular Claude Code interaction for best results

---

## File Locations

Skills installed in: `~/.claude/skills/`

Each skill directory contains:
- `skill.md` - The skill definition

To update a skill:
1. Edit the corresponding `~/.claude/skills/SKILL_NAME/skill.md` file
2. Changes take effect immediately

---

## Future Engagements

For your next Azure pentest:
1. Navigate to new directory (or create one)
2. Run `/azure-pentest-init`
3. Answer prompts
4. Start testing immediately

All skills are reusable across unlimited engagements!
