#!/usr/bin/env bash
#
# Pre-commit hook for PAI repository
#
# This hook performs TWO critical functions:
# 1. Security scanning - Prevents sensitive content from being committed
# 2. Documentation updates - Automatically updates docs based on changes
#
# INSTALLATION:
# cp hooks/pre-commit-with-docs.template .git/hooks/pre-commit
# chmod +x .git/hooks/pre-commit
#
# Or use: bun run setup.sh
#

# ============================================================================
# DOCUMENTATION UPDATE PHASE
# ============================================================================
# Automatically updates documentation based on what files were changed
# ============================================================================

# Check if the documentation updater script exists
if [ -f "hooks/update-documentation.ts" ]; then
    # Run the documentation updater
    # Note: This runs but doesn't block the commit if it fails
    if ! bun run hooks/update-documentation.ts; then
        echo -e "\033[1;33m⚠️  Documentation update encountered an issue (non-blocking)\033[0m"
        echo -e "\033[1;33m   The commit will proceed, but you may want to review documentation manually\033[0m"
    fi
fi

# ============================================================================
# SECURITY SCANNING PHASE
# ============================================================================
# Add your existing security scanning logic here, or integrate with the
# existing .git/hooks/pre-commit security scanner
# ============================================================================

exit 0
